syntax = "proto3";

package com.guardix.grpc;

option java_multiple_files = true;
option java_package = "com.guardix.grpc.malware";
option java_outer_classname = "MalwareProto";

// Malware Detection Service
service MalwareService {
    rpc AnalyzeMalware(MalwareRequest) returns (MalwareResponse);
    rpc BatchAnalyzeMalware(BatchMalwareRequest) returns (BatchMalwareResponse);
}

// Request message for malware analysis
message MalwareRequest {
    string package_name = 1;
    repeated string permissions = 2;
    repeated string api_calls = 3;
    repeated string behaviors = 4;
    map<string, string> metadata = 5;
}

// Response message for malware analysis
message MalwareResponse {
    bool is_malicious = 1;
    double confidence = 2;
    string risk_level = 3;
    map<string, string> details = 4;
    repeated string suspicious_features = 5;
    int64 analysis_timestamp = 6;
}

// Batch request for multiple apps
message BatchMalwareRequest {
    repeated MalwareRequest requests = 1;
}

// Batch response for multiple apps
message BatchMalwareResponse {
    repeated MalwareResponse responses = 1;
}
syntax = "proto3";

package com.guardix.grpc;

option java_multiple_files = true;
option java_package = "com.guardix.grpc.biometric";
option java_outer_classname = "BiometricProto";

// Biometric Authentication Service
service BiometricService {
    rpc AuthenticateUser(BiometricRequest) returns (BiometricResponse);
    rpc EnrollUser(EnrollmentRequest) returns (EnrollmentResponse);
    rpc UpdateBiometricProfile(UpdateProfileRequest) returns (UpdateProfileResponse);
}

// Request message for biometric authentication
message BiometricRequest {
    string user_id = 1;
    BiometricFeatures features = 2;
    string device_id = 3;
    int64 timestamp = 4;
}

// Biometric features
message BiometricFeatures {
    repeated double keystroke_dynamics = 1;
    repeated double touch_patterns = 2;
    repeated double behavioral_metrics = 3;
    map<string, double> additional_features = 4;
}

// Response message for biometric authentication
message BiometricResponse {
    bool is_authenticated = 1;
    double confidence_score = 2;
    string authentication_level = 3;
    string session_token = 4;
    map<string, string> additional_info = 5;
    int64 response_timestamp = 6;
}

// Request message for user enrollment
message EnrollmentRequest {
    string user_id = 1;
    repeated BiometricFeatures training_samples = 2;
    string device_id = 3;
}

// Response message for user enrollment
message EnrollmentResponse {
    bool enrollment_successful = 1;
    string enrollment_id = 2;
    string message = 3;
    int32 samples_required = 4;
}

// Request message for profile update
message UpdateProfileRequest {
    string user_id = 1;
    BiometricFeatures new_features = 2;
    bool adaptive_learning = 3;
}

// Response message for profile update
message UpdateProfileResponse {
    bool update_successful = 1;
    string message = 2;
    double profile_accuracy = 3;
}